# 競輪高配当予測システム 使い方マニュアル

## 📱 システムの特徴

### ✅ 完全に事前情報のみ使用
- レース結果は一切使用しません
- 全て**レース前に入手可能な情報**のみで予測します

### ✅ iPhone単体で完結
- PCは一切不要
- ブラウザでアクセスするだけ
- Render.comにデプロイ済み

### ✅ 高精度予測
- モデル精度：77.12%
- 58個の特徴量を使用
- 2,499名の選手データベース

---

## 🎯 システムの目的

このシステムは **「高配当レースを見つける」** ためのものです。

### 高配当レース = 荒れるレース

- 人気上位が崩れる
- 人気薄の選手が好走する
- オッズが高い組み合わせが的中する

### システムが行うこと

1. 全出走選手（7〜9名）の過去成績を分析
2. 全ての3連単組み合わせ（最大504通り）を評価
3. **「人気薄だが実力がある」** 組み合わせを特定
4. 高配当が期待できる買い目トップ10を推奨

---

## 📋 使い方（ステップバイステップ）

### 準備：KEIRIN.JPで出走表を確認

1. **KEIRIN.JP** (https://keirin.jp/) にアクセス
2. 予想したいレースを選択
3. **出走表**を開く

出走表に記載されている情報（レース前に全て入手可能）：
```
場名：平塚競輪
グレード：F1
カテゴリー：一般
レース番号：第1レース

出走選手：
1番車：山田太郎（千葉）
2番車：佐藤次郎（東京）
3番車：鈴木三郎（埼玉）
4番車：田中四郎（神奈川）
5番車：伊藤五郎（茨城）
6番車：渡辺六郎（群馬）
7番車：中村七郎（栃木）
```

---

### ステップ1：アプリにアクセス

**URL:** https://keirin-predictor.onrender.com （デプロイ後のURL）

iPhoneのSafariでアクセスしてください。

---

### ステップ2：レース情報を入力

#### 1. 場名
```
例：平塚
```

#### 2. グレード
プルダウンから選択：
- F1
- F2
- G1
- G2
- G3

#### 3. カテゴリー
```
例：一般、特選、決勝 など
```

#### 4. レース番号（任意）
```
例：1R、2R など
```

---

### ステップ3：全選手を入力

**重要：出走する全選手（7〜9名）を入力してください**

#### 各選手の情報：
- **車番**：1〜9の数字
- **選手名**：フルネーム（姓と名の間にスペース）

#### 例：
```
1番車：山田　太郎
2番車：佐藤　次郎
3番車：鈴木　三郎
4番車：田中　四郎
5番車：伊藤　五郎
6番車：渡辺　六郎
7番車：中村　七郎
```

#### 選手の追加・削除：
- **選手を追加**：「➕ 選手を追加」ボタンをタップ
- **選手を削除**：各行の「✕」ボタンをタップ

---

### ステップ4：予測を実行

「🔮 予測する」ボタンをタップ

**処理時間：** 約5〜10秒
- 全組み合わせ（210〜504通り）を評価します

---

## 📊 結果の見方

### 1. レース全体の分析

```
レース全体の荒れ度：高
高配当平均確率：35.6%
評価した組み合わせ：210通り
```

#### 荒れ度の意味：
- **高**：高配当の可能性が非常に高い（35%以上）
- **中**：中程度の高配当期待（25〜35%）
- **低**：堅いレースの可能性（25%未満）

---

### 2. 推奨買い目 Top 10

各推奨には以下の情報が表示されます：

#### 例：
```
1位
7-3-6

山崎　歩夢 → 尾方　真生 → 市田龍生都

━━━━━━━━━━━━━━━━━━━━━━
46.5%
━━━━━━━━━━━━━━━━━━━━━━

高配当確率が非常に高い、実力者揃いで波乱の可能性、実力が拮抗

勝率: 85.1% / 85.2% / 96.4%
```

#### 情報の読み方：

**順位**
- 期待値スコアが高い順にランキング
- 上位3位は特に強調表示

**組み合わせ（例：7-3-6）**
- 3連単の車番
- この順番で買うことを推奨

**選手名**
- → で着順を表示
- 例：1着→2着→3着

**高配当確率（バー）**
- この組み合わせが高配当になる確率
- 40%以上は非常に高い

**推奨理由**
- なぜこの組み合わせを推奨するか
- 例：
  - 「高配当確率が非常に高い」
  - 「人気薄だが好走の期待」
  - 「実力が拮抗」

**勝率**
- 各選手の過去の勝率
- 参考情報として表示

---

## 💡 買い方の戦略

### 戦略1：トップ3を重点的に

```
1位の買い目：1,000円
2位の買い目：500円
3位の買い目：300円
```

最も期待値が高い上位3つに集中投資

---

### 戦略2：トップ10を広く

```
1〜10位の買い目：各200円（合計2,000円）
```

的中率を高めるため広く購入

---

### 戦略3：荒れ度で判断

#### レースが「高」の場合：
- トップ5を重点的に購入
- 高配当が期待できる

#### レースが「中」の場合：
- トップ3と好みで数点追加

#### レースが「低」の場合：
- 購入を見送るか、トップ1-2のみ

---

## 🔍 システムの仕組み（技術的詳細）

### 使用している特徴量（58個）

#### 選手の過去成績（各選手×8特徴量 = 24）
- 勝率
- 連対率（2着以内率）
- 3着内率
- 高配当レース出場率
- 最近20レースの勝率
- この場所での勝率
- このグレードでの勝率
- 成績の安定性

#### 統計的特徴（14特徴量）
- 3選手の平均勝率
- 3選手の勝率の標準偏差
- 最高勝率と最低勝率
- 実力差の指標

#### 車番の特徴（10特徴量）
- 車番の合計
- 車番の分布
- 外枠・内枠の数
- 特定車番（1番、9番）の有無

#### 車番組み合わせ統計（1特徴量）
- この車番の組み合わせの過去の高配当率

#### グレード（5特徴量）
- F1, F2, G1, G2, G3

#### 交互作用特徴（4特徴量）
- 勝率×車番
- 高配当率×外枠数
- など

---

### 予測の流れ

1. **全組み合わせを生成**
   - 7選手：210通り（7P3）
   - 8選手：336通り（8P3）
   - 9選手：504通り（9P3）

2. **各組み合わせの特徴量を計算**
   - 58個の特徴量を構築
   - 選手の過去成績をデータベースから取得

3. **機械学習モデルで予測**
   - LightGBMモデル（精度77.12%）
   - 高配当確率を算出

4. **期待値スコアを計算**
   ```
   期待値スコア = 高配当確率 / 人気度
   ```
   - 人気薄で高配当確率が高い組み合わせが高スコア

5. **スコア順にランキング**
   - 上位10件を推奨

---

## ❓ よくある質問

### Q1: 選手名が見つからない場合は？

**A:** 新人選手など、データベースに登録されていない選手の場合：
- デフォルト値（勝率10%など）が使用されます
- 予測は可能ですが、精度は若干低下します

---

### Q2: なぜ全選手を入力する必要があるの？

**A:** 高配当を見つけるため、全体像が必要です：
- 人気上位を知るため
- 人気薄を特定するため
- 実力差を把握するため

3選手だけでは「荒れるかどうか」の判断ができません。

---

### Q3: 本命が強い場合は？

**A:** システムは「荒れ度」も表示します：
- 荒れ度が「低」= 本命が強い堅いレース
- この場合は購入を見送るのも戦略です

---

### Q4: 的中率はどのくらい？

**A:** モデルの精度は77.12%ですが：
- これは「高配当になるかどうか」の予測精度
- 3連単の的中率とは異なります
- 推奨買い目の的中率は20〜30%程度を想定

---

### Q5: iPhone以外でも使える？

**A:** はい、使えます：
- PCのブラウザでもアクセス可能
- ただし、iPhoneでの使用を想定した設計です

---

## ⚠️ 注意事項

### 1. 投資は自己責任で
- このシステムは参考情報を提供するものです
- 的中を保証するものではありません
- 投資判断は自己責任でお願いします

### 2. ギャンブル依存症に注意
- 適度な範囲で楽しんでください
- 予算を決めて守ってください

### 3. システムの限界
- 予測精度は77.12%（完璧ではありません）
- レース当日の天候、選手の体調などは考慮されません

---

## 📈 システムの改善履歴

### v1.0（初期版）
- 3選手のみ対応
- 精度：70.76%

### v2.0（現在）
- 全選手（7〜9名）対応
- 精度：77.12%（+6.36%改善）
- 58特徴量に拡張
- 全組み合わせ評価機能追加
- 車番組み合わせ統計追加

---

## 🎉 まとめ

このシステムを使えば：

✅ **事前情報のみ**で高精度予測
✅ **iPhone単体**で完結
✅ **全組み合わせ**を自動評価
✅ **高配当が期待できる買い目**を推奨

**競輪予想の強力なツール**としてご活用ください！

---

## 📞 サポート

問題がある場合：
- GitHub Issues: https://github.com/[your-repo]/issues
- システムの技術的詳細は README.md を参照

---

**最終更新：2025年11月11日**
**バージョン：v2.0**
**モデル精度：77.12%**
